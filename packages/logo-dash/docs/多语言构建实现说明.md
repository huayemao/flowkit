# LogoDash 多语言构建实现说明

## 1. 概述

LogoDash项目实现了多语言构建功能，支持为不同语言生成独立的HTML文件，同时保持共享的JavaScript和CSS资源。本文档详细说明该功能的实现原理、核心代码结构以及注意事项。

## 2. 核心实现原理

### 2.1 整体流程

1. **清理构建目录**：删除之前的构建文件
2. **一次构建应用**：只构建一次应用程序，生成共享的JS和CSS文件
3. **读取翻译文件**：获取不同语言的翻译内容
4. **生成多语言HTML**：为每种语言创建独立的HTML文件，注入对应的翻译内容
5. **修复资源路径**：对于非默认语言，调整静态资源的引用路径

### 2.2 关键代码位置

多语言构建的核心逻辑位于：`scripts/build-multilingual.js`

## 3. 核心代码结构解析

### 3.1 主函数流程

```javascript
// 主函数，包装为异步函数
async function main() {
  // 获取当前目录信息
  const __filename = fileURLToPath(import.meta.url);
  const __dirname = dirname(__filename);

  // 支持的语言配置
  const supportedLangs = ['en', 'zh'];
  const defaultLang = 'en';
  // 语言代码映射配置
  const langCodeMap = {
    'en': 'en-US',
    'zh': 'zh-CN'
  };
  const rootDir = resolve(__dirname, '..');
  const distDir = resolve(rootDir, 'dist-demo');

  // 清理之前的构建目录
  // 只构建一次应用程序
  // 读取默认构建的HTML文件
  // 为每种语言生成HTML文件
  // 显示输出目录结构
}
```

### 3.2 语言处理与HTML生成

核心问题解决：**替换特定的SEO元标签而不是整个head部分**，以保留Vite打包生成的script和link标签。

```javascript
// 为每种语言生成HTML文件
supportedLangs.forEach((lang, index) => {
  // 获取翻译内容
  const translations = getTranslations(lang);
  const logoDashTranslations = translations.logoDash || {};

  // 设置输出目录和文件路径
  let outputDir = distDir;
  let htmlOutputPath = resolve(distDir, 'index.html');

  // 非默认语言放入子目录
  if (lang !== defaultLang) {
    outputDir = resolve(distDir, lang);
    if (!existsSync(outputDir)) {
      mkdirSync(outputDir, { recursive: true });
    }
    htmlOutputPath = resolve(outputDir, 'index.html');
  }

  // 从翻译文件中获取SEO内容
  const currentSeo = {
    title: logoDashTranslations.title || (lang === 'zh' ? 'LogoDash - Logo设计工具 | 轻松创建专业标志' : 'LogoDash - Logo Design Tool'),
    // 其他SEO元数据...
  };

  // 修改HTML内容 - 保留Vite生成的head内容，只替换需要国际化的部分
  let modifiedHtml = defaultHtmlContent
    // 设置lang属性
    .replace(/<html lang="[^"]+">/, `<html lang="${langCodeMap[lang] || lang}">`)
    // 替换特定的SEO元标签
    .replace(/<title>[^<]+<\/title>/, `<title>${currentSeo.title}</title>`)
    .replace(/<meta name="description" content="[^"]+